<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>

<script>
  function galleryRowHeight() {
    return window.innerWidth >= 1024 ? 340 :
           window.innerWidth >= 640  ? 280 : 220;
  }

  function initGallery() {
    const $g = $(".justified-gallery");
    if (!$g.length) return;

    // If it was already initialized, reset it
    if ($g.data("jg.initialized")) {
      $g.justifiedGallery("destroy");
    }

    $g.justifiedGallery({
      rowHeight: galleryRowHeight(),
      margins: 8,
      lastRow: "nojustify"
    });
  }

  window.addEventListener("load", function () {
    initGallery();
    GLightbox({ selector: ".glightbox", touchNavigation: true, loop: true });
  });

  window.addEventListener("resize", function () {
    initGallery();
  });
</script>


<style>
/* Only apply on pages that actually have a post body */
main:has(.article-content) .max-w-fit,
main:has(.article-content) .min-w-0.min-h-0.max-w-fit {
  max-width: none !important;
  width: 100% !important;
}

/* Make sure the gallery itself is full width */
main:has(.article-content) .article-content,
main:has(.article-content) .article-content .justified-gallery,
main:has(.article-content) .article-content #gallery {
  max-width: none !important;
  width: 100% !important;
  display: block !important;
}
</style>
